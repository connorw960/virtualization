\documentclass[11pt]{article}
\usepackage[letterpaper, margin=2cm]{geometry}
\usepackage{titlesec}
\usepackage{mdframed}
\usepackage[dvipsnames]{xcolor} % for color names, must be loaded before tikz
\usepackage{ifthen}
\usepackage{comment}
\usepackage{fancyhdr}
\usepackage{fancyvrb}
\usepackage{titling}
\usepackage{hyperref}
\usepackage{enumitem}
\usepackage{tikz}
\usepackage{amsmath, amssymb, amsthm}

\providecommand{\due}{}
\lhead{Virtualization} \rhead{The University of Texas}
\lfoot{\due} \cfoot{} \rfoot{Page \thepage}
\renewcommand{\footrulewidth}{0.4pt}
\pagestyle{fancy}

% Eliminates the spacing in the title that remains from the empty author section.
\preauthor{}
\postauthor{}

\titleformat{\section}[runin]{\large\bfseries}{\thesection .}{3pt}{}
\titleformat{\subsection}[runin]{\bfseries}{\thesubsection)}{3pt}{}
\renewcommand\thesubsection{\alph{subsection}}

% Defines the solution environment. Toggle solutions between true and false to either show or hide solutions. Also, the solution environment takes an optional argument of arbitrary text to be inserted in the solution header.
\newboolean{solutions}
\setboolean{solutions}{true}
\ifthenelse{\boolean{solutions}}
{\newenvironment{solution}{\begin{mdframed}[skipbelow=0pt, linecolor=White, backgroundcolor=Green!10]\textbf{Solution:}}{\end{mdframed}}}
{\excludecomment{solution}}

\allowdisplaybreaks

\begin{document}

\title{Virtualization\\Pre-lab Questions --- \#2}
\date{\due}

\maketitle

\noindent \textbf{Point total:} 5
\\ All homework assignments are weighted equally in the final grade. Point values are unique to each lab assignment.

\textbf{Note:} For all problems which ask you to explain your reasoning or show your work, you do not need to show every step of each calculation, but the answer should include an explanation \emph{written with words} of what you did.  Even when work is not required to be shown, itâ€™s a good idea to include anyways so that you can earn partial credit.

\section{Question [1 point]}

What does it mean for there to be EPT support, 
vs. software driven virtualization? 
How do we know our VM has EPT support?

\begin{solution}
At a high level, EPT is hardware assisted virtualization. Really, EPT vs. software 
driven comes down to using extended page tables or shadow page tables. 

We know out VM has EPT support by looking certain bits in the CTLS2 MSR. (Base assumption is 
we are using an Intel processor.)
\end{solution}


\section{Question [1 point]}

ELF Headers:
What is an ELF header? What does it do?

\begin{solution}
An ELF (Executable and Linkable Format) header is a portion of ELF files (realy any executable file e.g. *.bin) 
that contains key info that the OS uses to correctly interpret the ELF files. It contains information 
such as whether the file is meant for a 32 or 64 bit architecture, what type of file it is, the target OS ABI,
 the memory address of the entry point, and much more. Essentially it tells the OS how to run the executable. 
\end{solution}


\section{Question [1 point]}

Set a breakpoint at the function \texttt{load\_icode\(\)} in env.c 
What do you notice about the Proghdr object? 
What kinds of metadata does the object have? 
What is this function doing? It is described in the function header, 
but try to put it in your own words.

\begin{solution}
Your answer here.
\end{solution}


\section{Question [1 point]}

In our codebase, \texttt{load\_icode\(\)} does the work of loading the ELF 
binary image into the environment's user memory. Looking at this function, 
where does the memory for the Env get allocated? Where does the memory for the ELF header 
get allocated? Hint: you may have to check out what some constant values mean.

\begin{solution}
Your answer here.
\end{solution}


\section{Question [1 point]}

The first function you implement in this project will have you check many errors, 
prior to the actual function logic. What are some of the reasons why we must do this 
in OS level code that the user never sees?

\begin{solution}
Errors in the OS can be catastrophic. This is the reason we do OS development inside a VM so we can just reload 
to the last stable state when it all falls apart. 
So many of the reasons we do error checking at O level code are the same as user level code: 
stability, security, debugging, overall experience, best practices etc. But, since the 
code is at an OS level we need to account for nearly every error that can happen so there aren't 
severe downstream effects. 
\end{solution}


\end{document}

